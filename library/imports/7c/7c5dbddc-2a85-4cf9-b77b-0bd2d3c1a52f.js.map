{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        btnUpdate : cc.Node,\r\n        manifest : cc.RawAsset,\r\n        labelMsg : cc.Label,\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n\r\n        this.btnUpdate.active = false;\r\n        \r\n        var storagePath = ((jsb.fileUtils ? jsb.fileUtils.getWritablePath() : '/'));\r\n        this._am = new jsb.AssetManager(this.manifest,storagePath);\r\n        this._checkListener = new jsb.EventListenerAssetsManager(this._am,this.checkUpdateCB.bind(this));\r\n        \r\n        cc.eventManager.addListener(this._checkListener,1);\r\n\r\n        this.strBtnState = \"CHECK_UPDATE\";\r\n        \r\n        this.btnUpdate.active = true;\r\n    },\r\n\r\n    clickBtn : function () {\r\n\r\n        this.btnUpdate.active = false;\r\n        switch (this.strBtnState)\r\n        {\r\n            case \"CHECK_UPDATE\":\r\n                this._am.checkUpdate();\r\n                break;\r\n            case \"UPDATE\":\r\n                this._am.update();\r\n                break;\r\n            case \"RESTARTGAME\":\r\n                cc.game.restart();\r\n                break;\r\n        }\r\n    },\r\n    checkUpdateCB : function (event) {\r\n\r\n        cc.log('Code: ' + event.getEventCode());\r\n        switch (event.getEventCode())\r\n        {\r\n            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\r\n                this.labelMsg.string = \"No local manifest file found, hot update skipped.\";\r\n                break;\r\n            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\r\n            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\r\n                this.labelMsg.string = \"Fail to download manifest file, hot update skipped.\";\r\n                break;\r\n            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\r\n                this.labelMsg.string = \"Already up to date with the latest remote version.\";\r\n                break;\r\n            case jsb.EventAssetsManager.NEW_VERSION_FOUND:\r\n                this.labelMsg.string = 'New version found, please try to update.';\r\n\r\n                this._updateListener = new jsb.EventListenerAssetsManager(this._am, this.updateCB.bind(this));\r\n                cc.eventManager.addListener(this._updateListener, 1);\r\n                //this._am.update();\r\n                this.strBtnState = \"UPDATE\";\r\n                this.btnUpdate.active = true;\r\n                break;\r\n            default:\r\n                console.log(\"checkCB in default !!\");\r\n                //this._updateListener = new jsb.EventListenerAssetsManager(this._am, this.updateCB.bind(this));\r\n                //cc.eventManager.addListener(this._updateListener, 1);\r\n                //this._am.update();\r\n                return;\r\n        }\r\n\r\n        cc.eventManager.removeListener(this._checkListener);\r\n        this._checkListener = null;\r\n    },\r\n\r\n    updateCB : function () {\r\n\r\n        console.log(\"updateCB 0\");\r\n\r\n        var needRestart = false;\r\n        var failed = false;\r\n        switch (event.getEventCode())\r\n        {\r\n            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\r\n                this.labelMsg.string = 'No local manifest file found, hot update skipped.';\r\n                failed = true;\r\n                break;\r\n            case jsb.EventAssetsManager.UPDATE_PROGRESSION:\r\n                break;\r\n            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\r\n            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\r\n                this.labelMsg.string = 'Fail to download manifest file, hot update skipped.';\r\n                failed = true;\r\n                break;\r\n            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\r\n                this.labelMsg.string = 'Already up to date with the latest remote version.';\r\n                failed = true;\r\n                break;\r\n            case jsb.EventAssetsManager.UPDATE_FINISHED:\r\n                this.labelMsg.string = 'Update finished. ' + event.getMessage();\r\n                needRestart = true;\r\n                break;\r\n            case jsb.EventAssetsManager.UPDATE_FAILED:\r\n                this.labelMsg.string = 'Update failed. ' + event.getMessage();\r\n                //this.panel.retryBtn.active = true;\r\n                //this._canRetry = true;\r\n                break;\r\n            case jsb.EventAssetsManager.ERROR_UPDATING:\r\n                this.labelMsg.string = 'Asset update error: ' + event.getAssetId() + ', ' + event.getMessage();\r\n                break;\r\n            case jsb.EventAssetsManager.ERROR_DECOMPRESS:\r\n                this.labelMsg.string = event.getMessage();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n        if (failed) {\r\n            cc.eventManager.removeListener(this._updateListener);\r\n            this._updateListener = null;\r\n        }\r\n\r\n        if (needRestart) {\r\n            cc.eventManager.removeListener(this._updateListener);\r\n            this._updateListener = null;\r\n\r\n            // Prepend the manifest's search path\r\n            var searchPaths = jsb.fileUtils.getSearchPaths();\r\n            var newPaths = this._am.getLocalManifest().getSearchPaths();\r\n            console.log(JSON.stringify(newPaths));\r\n\r\n\r\n            //var a = [1, 2, 3];\r\n            //a.unshift(4, 5);\r\n            //console.log(a); // [4, 5, 1, 2, 3]\r\n            Array.prototype.unshift(searchPaths, newPaths);\r\n\r\n            // This value will be retrieved and appended to the default search path during game startup,\r\n            // please refer to samples/js-tests/main.js for detailed usage.\r\n            // !!! Re-add the search paths in main.js is very important, otherwise, new scripts won't take effect.\r\n            cc.sys.localStorage.setItem('HotUpdateSearchPaths', JSON.stringify(searchPaths));\r\n\r\n            jsb.fileUtils.setSearchPaths(searchPaths);\r\n            //cc.game.restart();\r\n\r\n            this.strBtnState = \"RESTARTGAME\";\r\n            this.btnUpdate.active = true;\r\n        }\r\n    },\r\n\r\n});\r\n"
  ]
}